{% extends 'base/sidebar.html' %}

{%load static%} 

{% load permission_tags %}
{% block content %}

{%block css%} 
<link rel="stylesheet" href="{% static '/css/base.css'%}">
{%endblock%}  

<body>
    <h2>Crear personal</h2>
    <form method="POST" class="container2">
        <div class="form1" >
            {% csrf_token %} <!--validar -->
            {{ from_personal}}
            <input class="button" type="submit" value="Crear Personal">
            <script>
                function eliminarPersonal(id){
                    Swal.fire({
                    "title": '¿Estás seguro?',
                    "text": "Una vez borrado no se podrá recuperar",
                    "icon": 'warning ',
                    "showCancelButton": true,
                    "confirmButtonColor": '#3085d6',
                    "cancelButtonColor": '#d33',
                    "cancelButtonText":"No, Cancelar", 
                    "confirmButtonText": 'Si, Eliminar',
                    "reverseButtons":true  
            
                    }).then(function(result) {
                        if (result.isConfirmed) {
                        window.location.href = "/delete_staff/"+id+"/"
                    }
                    })
            
                }
            </script>
            <form method="POST"  class="container2">
                <div class="form1">
                <table class="table table-bordered"> 
                    {% load permission_tags %}
                        {% if personal  %}    
                            {% if user|has_role:'administrador'  %}
                                <h2 class="reg-prod">Lista de personal registrados </h2>
                                <hr width="50%"> 
                                <thead>
                                    <tr>
                                        <th>id</th>
                                        <th>Usuario</th>
                                        <th>Rut </th>
                                        <th>Teléfono</th>
                                        <th>Dirección</th>
                                        <th>País</th>
                                        <th>Profesión</th>
                                        <th>Sexo</th>
                                        <th>Tipo Personal</th>
                                        <th>Opciones</th>
                                        
                                    </tr>
                                </thead>        
                                {% for p in personal %} 
                                <tbody> 
                                    <tr>
                                        <td> {{ p.id }} </td>
                                        <td>{{ p.usuario_fk  }}</td>
                                        <td>{{ p.rut_personal  }}</td>
                                        <td>{{ p.movil_personal  }}</td>
                                        <td>{{ p.direccion_personal  }}</td>
                                        <td>{{ p.pais_personal.name }}</td>
                                        <td>{{ p.profesion_personal  }}</td>
                                        <td>{{ p.sexo_personal  }}</td>
                                        <td>{{ p.tipo_personal_fk  }}</td>
                                        <td>
                                            <a href="{%  url 'modify_staff' p.id %}" class="btn btn-info btn-sm ">Modificar</a>
                                            <a href="#" onclick="eliminarPersonal({{ p.id }})  " class="btn btn-danger btn-sm ">Eliminar</a>
                                        </td>
                                    </tr>   
                                </tbody>
                                {% endfor %}     
                            {% endif %}      
                        {% else %}
                        <h3>No hay registros</h3>
                    {% endif %}
                </table>            
                </div>
            </form>
        </div>
    </form>
</body>

{% endblock content %}